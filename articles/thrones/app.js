webpackJsonp([0],{0:function(t,e,n){n(1),t.exports=n(2)},1:function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return v.iterable&&(e[Symbol.iterator]=function(){return e}),e}function r(t){this.map={},t instanceof r?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function a(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function s(t){var e=new FileReader;return e.readAsArrayBuffer(t),a(e)}function u(t){var e=new FileReader;return e.readAsText(t),a(e)}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(v.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(v.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(t){if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob?(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(s)},this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=i(this);return t?t:Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(t){var e=t.toUpperCase();return m.indexOf(e)>-1?e:t}function f(t,e){e=e||{};var n=e.body;if(f.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new r(t.headers)),this.method=t.method,this.mode=t.mode,n||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new r(e.headers)),this.method=c(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function h(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(r))}}),e}function d(t){var e=new r,n=(t.getAllResponseHeaders()||"").trim().split("\n");return n.forEach(function(t){var n=t.trim().split(":"),o=n.shift().trim(),r=n.join(":").trim();e.append(o,r)}),e}function p(t,e){e||(e={}),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof r?e.headers:new r(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var v={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};r.prototype.append=function(t,o){t=e(t),o=n(o);var r=this.map[t];r||(r=[],this.map[t]=r),r.push(o)},r.prototype.delete=function(t){delete this.map[e(t)]},r.prototype.get=function(t){var n=this.map[e(t)];return n?n[0]:null},r.prototype.getAll=function(t){return this.map[e(t)]||[]},r.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},r.prototype.set=function(t,o){this.map[e(t)]=[n(o)]},r.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(o){t.call(e,o,n,this)},this)},this)},r.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),o(t)},r.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),o(t)},r.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),o(t)},v.iterable&&(r.prototype[Symbol.iterator]=r.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this)},l.call(f.prototype),l.call(p.prototype),p.prototype.clone=function(){return new p(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new r(this.headers),url:this.url})},p.error=function(){var t=new p(null,{status:0,statusText:""});return t.type="error",t};var y=[301,302,303,307,308];p.redirect=function(t,e){if(y.indexOf(e)===-1)throw new RangeError("Invalid status code");return new p(null,{status:e,headers:{location:t}})},t.Headers=r,t.Request=f,t.Response=p,t.fetch=function(t,e){return new Promise(function(n,o){function r(){return"responseURL"in a?a.responseURL:/^X-Request-URL:/m.test(a.getAllResponseHeaders())?a.getResponseHeader("X-Request-URL"):void 0}var i;i=f.prototype.isPrototypeOf(t)&&!e?t:new f(t,e);var a=new XMLHttpRequest;a.onload=function(){var t={status:a.status,statusText:a.statusText,headers:d(a),url:r()},e="response"in a?a.response:a.responseText;n(new p(e,t))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.open(i.method,i.url,!0),"include"===i.credentials&&(a.withCredentials=!0),"responseType"in a&&v.blob&&(a.responseType="blob"),i.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),a.send("undefined"==typeof i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},2:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u),c=n(33),f=o(c),h=n(180);n(210);var d=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=.2,a=window.innerWidth,s=window.innerHeight,u=o*s,l=a,c=s+u,f=n.parseHash(initEvents.length);return n.state={width:l,height:c,dh:u,flat:!1,zoomIn:!1,autoPlay:!1,disableControl:!1,showTip:!1,tipIdx:0,showMenu:!1,music:"./media/thrones.mp3",currEventIdx:f,events:initEvents,stories:initStories},n.zoomInTimerId=null,n.zoomOutTimerId=null,n.zoomOutTimerId2=null,n.playBeforeZoom=null,n.setCurrEventIdx=n.setCurrEventIdx.bind(n),n.changeZoomIn=n.changeZoomIn.bind(n),n.clickBtnMorph=n.clickBtnMorph.bind(n),n.clickBtnPlay=n.clickBtnPlay.bind(n),n.clickBtnTip=n.clickBtnTip.bind(n),n.clickBtnMenu=n.clickBtnMenu.bind(n),n.clickTipClose=n.clickTipClose.bind(n),n.changeTipIdx=n.changeTipIdx.bind(n),n}return a(e,t),s(e,[{key:"parseHash",value:function(t){var e=window.location.hash;if(/^#\d+$/.test(e)){var n=e.slice(1)-0;return n<t&&n>0?n:0}return 0}},{key:"clickBtnMorph",value:function(){var t=this.state.flat;this.setState({flat:!t})}},{key:"clickBtnPlay",value:function(){var t=this.state.autoPlay;this.setState({autoPlay:!t})}},{key:"clickBtnTip",value:function(){var t=this.state.showTip;t||this.setState({showTip:!0,flat:!1,autoPlay:!1})}},{key:"clickBtnMenu",value:function(){var t=this.state.showMenu;this.setState({showMenu:!t})}},{key:"clickTipClose",value:function(){this.setState({showTip:!1,tipIdx:0})}},{key:"changeTipIdx",value:function(){var t=5,e=this.state.tipIdx+1;e>t?this.setState({showTip:!1,tipIdx:0}):this.setState({tipIdx:e})}},{key:"componentDidUpdate",value:function(t,e){var n=this,o=e.zoomIn,r=this.state,i=r.zoomIn,a=r.autoPlay,s=this.refs.clouds,u=this.refs.detail;i!=o&&(i?(this.playBeforeZoom=a,this.setState({disableControl:!0,autoPlay:!1}),this.zoomSpace(!0).onComplete(function(t){s.setMode("zoomIn")}).start(),clearTimeout(this.zoomInTimerId),this.zoomInTimerId=setTimeout(function(t){s.setMode("hide"),u.setMode("show"),n.setState({disableControl:!1})},1600)):(this.setState({disableControl:!0}),u.setMode("hide"),clearTimeout(this.zoomOutTimerId),clearTimeout(this.zoomOutTimerId2),this.zoomOutTimerId=setTimeout(function(t){s.setMode("zoomOut"),n.zoomOutTimerId2=setTimeout(function(t){s.setMode("hide"),n.zoomSpace(!1).onComplete(function(t){n.setState({disableControl:!1,autoPlay:n.playBeforeZoom})}).start()},1600)},800)))}},{key:"setCurrEventIdx",value:function(t){window.location.hash="#"+t,this.setState({currEventIdx:t})}},{key:"changeZoomIn",value:function(t){this.setState({zoomIn:t})}},{key:"render",value:function(){var t=this,e=this.state,n=e.width,o=e.height,r=e.dh,i=e.flat,a=e.music,s=e.stories,u=e.events,c=e.currEventIdx,f=e.zoomIn,d=e.autoPlay,p=e.showTip,v=e.showMenu,m=e.tipIdx,y=e.disableControl,b=114,g=.8*n,x=b,w=n,_=3*w/4;u[c];return l.default.createElement("div",{className:p?"tip-"+m:""},l.default.createElement(h.BtnMorph,{isFlat:i,onClick:this.clickBtnMorph,hide:f}),l.default.createElement(h.BtnPlay,{autoPlay:d,onClick:this.clickBtnPlay,hide:f,music:a}),l.default.createElement(h.BtnTip,{onClick:this.clickBtnTip,hide:f}),l.default.createElement(h.BtnMenu,{showMenu:v,onClick:this.clickBtnMenu,hide:f}),l.default.createElement(h.Detail,{ref:"detail",index:c,size:{width:n,height:o-r},onChangeIndex:this.setCurrEventIdx},u.map(function(t){return l.default.createElement("div",{key:t.id,className:"detail-box"},l.default.createElement("div",{className:"detail-image-box",style:{width:w,height:_}},l.default.createElement("img",{src:t.img,alt:t.title,className:"detail-image",width:w,style:{width:w,marginLeft:-w/2,marginTop:-_/2}})),l.default.createElement("div",{className:"detail-caption",style:{height:o-r-_-65},dangerouslySetInnerHTML:{__html:t.desc}}))})),l.default.createElement(h.Clouds,{ref:"clouds",width:n,height:o,top:-r,currEventIdx:c}),l.default.createElement(h.Space,{events:u,currEventIdx:c,width:n,height:o,top:-r,flatMap:i,ref:function(e){e&&(t.zoomSpace=e.zoom)}}),l.default.createElement(h.CardViewer,{disableControl:y,events:u,index:c,onChangeIndex:this.setCurrEventIdx,shrinked:f,onChangeShinked:this.changeZoomIn,autoPlay:d,resetAutoPlay:this.clickBtnPlay,containerSize:{width:n,height:b},itemSize:{width:g,height:x},itemSpacer:.05*n}),v?l.default.createElement(h.Menu,{size:{width:n,height:o-r-80},onClick:this.clickBtnMenu},s.map(function(t,e){return"#"==t.url?l.default.createElement("div",{key:e,className:"list-group-item menu-item-current"},t.title):l.default.createElement("a",{key:e,href:t.url,className:"list-group-item"+("#"==t.url?" menu-item-current":"")},t.title)})):"",p?l.default.createElement("div",{className:"btns-tip-overlayer"}):"",p?l.default.createElement(h.TipMask,{onClickClose:this.clickTipClose,size:{height:o,width:n,dh:r},tipIdx:m,onClickNext:this.changeTipIdx}):"")}}]),e}(l.default.Component);window.initApp=function(){f.default.render(l.default.createElement(d,null),document.getElementById("content"))}},180:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.TipMask=e.Menu=e.BtnMenu=e.BtnTip=e.BtnPlay=e.BtnMorph=e.CardViewer=e.Space=e.Detail=e.Clouds=void 0;var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u),c=n(181),f=o(c),h=n(186),d=o(h),p=n(189),v=o(p),m=n(201),y=o(m),b=n(204),g=o(b),x=n(207),w=o(x),_=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={hide:n.props.hide},n.hideTimerId=null,n}return a(e,t),s(e,[{key:"componentWillReceiveProps",value:function(t){var e=this,n=t.hide,o=this.props.hide;o!=n&&(n?this.setState({hide:!0}):(clearTimeout(this.hideTimerId),this.hideTimerId=setTimeout(function(t){e.setState({hide:!1})},2500)))}},{key:"render",value:function(){var t=this.props,e=t.onClick,n=t.isFlat,o=this.state.hide;return l.default.createElement("div",{className:"toggle-btn toggle-btn-morph",style:{left:5,top:5,display:o?"none":""},onClick:e},l.default.createElement("span",{className:"glyphicon "+(n?"glyphicon-globe":"glyphicon-th")}))}}]),e}(l.default.Component),T=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={hide:n.props.hide},n.hideTimerId=null,n}return a(e,t),s(e,[{key:"componentWillReceiveProps",value:function(t){var e=this,n=t.hide,o=t.autoPlay,r=this.props,i=r.hide,a=r.autoPlay;if(i!=n&&(n?this.setState({hide:!0}):(clearTimeout(this.hideTimerId),this.hideTimerId=setTimeout(function(t){e.setState({hide:!1})},2500))),a!=o){var s=this.refs.audio;o?(s.currentTime=0,s.play()):s.pause()}}},{key:"componentDidMount",value:function(){var t=this.props.autoPlay;t&&this.refs.audio.play()}},{key:"render",value:function(){var t=this.props,e=t.onClick,n=t.autoPlay,o=t.music,r=this.state.hide;return l.default.createElement("div",{className:"toggle-btn toggle-btn-play"+(n?" toggle-btn-playing":""),style:{left:5,top:50,display:r?"none":""},onClick:e},l.default.createElement("span",{className:"glyphicon "+(n?"glyphicon-pause":"glyphicon-play")}),l.default.createElement("audio",{ref:"audio",src:o,autoPlay:!1,loop:!0,controls:!1}))}}]),e}(l.default.Component),k=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={hide:n.props.hide},n.hideTimerId=null,n}return a(e,t),s(e,[{key:"componentWillReceiveProps",value:function(t){var e=this,n=t.hide,o=this.props.hide;o!=n&&(n?this.setState({hide:!0}):(clearTimeout(this.hideTimerId),this.hideTimerId=setTimeout(function(t){e.setState({hide:!1})},2500)))}},{key:"render",value:function(){var t=this.props.onClick,e=this.state.hide;return l.default.createElement("div",{className:"toggle-btn toggle-btn-tip",style:{left:5,top:95,display:e?"none":""},onClick:t},l.default.createElement("span",{className:"glyphicon glyphicon-question-sign"}))}}]),e}(l.default.Component),P=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={hide:n.props.hide},n.hideTimerId=null,n}return a(e,t),s(e,[{key:"componentWillReceiveProps",value:function(t){var e=this,n=t.hide,o=this.props.hide;o!=n&&(n?this.setState({hide:!0}):(clearTimeout(this.hideTimerId),this.hideTimerId=setTimeout(function(t){e.setState({hide:!1})},2500)))}},{key:"render",value:function(){var t=this.props,e=t.onClick,n=t.showMenu,o=this.state.hide;return l.default.createElement("div",{className:"toggle-btn toggle-btn-menu",style:{right:5,top:5,display:o?"none":""},onClick:e},l.default.createElement("span",{className:"glyphicon "+(n?"glyphicon-remove":"glyphicon-option-horizontal")}))}}]),e}(l.default.Component);e.Clouds=f.default,e.Detail=d.default,e.Space=v.default,e.CardViewer=y.default,e.BtnMorph=_,e.BtnPlay=T,e.BtnTip=k,e.BtnMenu=P,e.Menu=w.default,e.TipMask=g.default},181:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=n(3),c=o(l);n(182);var f=2*Math.PI,h=.2,d=1.2,p=-100,v=100,m=-100,y=100,b=-240,g=240,x=function(){var t=Math.random()*f,e=[Math.sin(t),Math.cos(t)],n=e[0],o=e[1],r=h+(d-h)*Math.random(),i=p+(v-p)*Math.random(),a=m+(y-m)*Math.random(),s=b+(g-b)*Math.random();return[r*o,-r*n,0,0,r*n,r*o,0,0,0,0,1,0,r*(i*o+a*n),r*(a*o-i*n),s,1]},w=function(t){var e=u(t,4),n=e[0],o=e[1],r=e[2],i=(e[3],n),a=n+o,s=n+o+r,l=Math.random();return l<i?"cloud.png":l<a?"explosion.png":l<s?"explosion2.png":"smoke.png"},_=function(t){var e=Math.random(),n=Math.random()*(1-e),o=Math.random()*(1-e-n),r=1-e-n-o,i=10,a=[e,n,o,r],s=[],u=[];a=a||[1,0,0,0];for(var l=0;l<i;l++)s.push(x()),u.push(w(a));return s[0][14]=240,u[0]="cloud.png",[s,u]},T=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,t),s(e,[{key:"shouldComponentUpdate",value:function(t,e){var n=t.clouds_matrix,o=this.props.clouds_matrix;return o!=n}},{key:"render",value:function(){var t=this.props,e=t.z0,n=t.clouds_matrix,o=t.clouds_img;return c.default.createElement("div",{className:"cloud-cluster"},n.map(function(t,n){t=t.slice(),t[14]=t[14]+e;var r="matrix3d("+t.join(",")+")",i="./img/"+o[n];return c.default.createElement("img",{className:"cloud",style:{transform:r,WebkitTransform:r},key:n,src:i})}))}}]),e}(c.default.Component),k=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=n.props.currEventIdx,a=_(o),s=u(a,2),l=s[0],c=s[1];return n.state={mode:"hide",clouds_matrix:l,clouds_img:c},n}return a(e,t),s(e,[{key:"setMode",value:function(t){this.setState({mode:t})}},{key:"componentWillReceiveProps",value:function(t){var e=t.currEventIdx,n=this.props.currEventIdx;if(n!=e){var o=_(e),r=u(o,2),i=r[0],a=r[1];this.setState({clouds_matrix:i,clouds_img:a})}}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=this.state,e=t.mode,n=t.clouds_matrix,o=t.clouds_img,r=this.props,i=r.width,a=r.height,s=r.top,u="zoomIn"==e?"clouds-zoomin":"zoomOut"==e?"clouds-zoomout":"clouds-hide";return c.default.createElement("div",{className:"clouds-wrapper "+u,style:{width:i,height:a,top:s,left:0}},c.default.createElement("div",{className:"clouds ",ref:"clouds"},c.default.createElement(T,{z0:0,clouds_matrix:n,clouds_img:o})))}}]),e}(c.default.Component);k.propTypes={mode:c.default.PropTypes.string},k.defaultProps={mode:"zoomIn"},e.default=k},182:function(t,e,n){var o=n(183);"string"==typeof o&&(o=[[t.id,o,""]]);n(185)(o,{});o.locals&&(t.exports=o.locals)},183:function(t,e,n){e=t.exports=n(184)(),e.push([t.id,"@-webkit-keyframes flycloud{0%{-webkit-transform:translateZ(420px);transform:translateZ(420px)}to{-webkit-transform:translateZ(150px);transform:translateZ(150px)}}@keyframes flycloud{0%{-webkit-transform:translateZ(420px);transform:translateZ(420px)}to{-webkit-transform:translateZ(150px);transform:translateZ(150px)}}.clouds-wrapper{-webkit-user-select:none;user-select:none;position:fixed;z-index:200;-webkit-perspective:400;perspective:400;overflow:hidden;background:transparent}.clouds{width:0;height:0;margin-left:0;margin-top:0;left:50%;top:50%;position:absolute;transform-style:preserve-3d}.clouds-zoomin .clouds{-webkit-animation:flycloud 1s linear 0s infinite reverse;animation:flycloud 1s linear 0s infinite reverse}.clouds-zoomout .clouds{-webkit-animation:flycloud 1s linear 0s infinite normal;animation:flycloud 1s linear 0s infinite normal}.clouds-hide{display:none}.cloud-cluster{width:0;height:0;margin-left:0;margin-top:0}.cloud,.cloud-cluster{left:50%;top:50%;position:absolute}.cloud{width:256px;height:256px;margin-left:-128px;margin-top:-128px;display:block;opacity:.8}",""])},184:function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},185:function(t,e,n){function o(t,e){for(var n=0;n<t.length;n++){var o=t[n],r=d[o.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](o.parts[i]);for(;i<o.parts.length;i++)r.parts.push(l(o.parts[i],e))}else{for(var a=[],i=0;i<o.parts.length;i++)a.push(l(o.parts[i],e));d[o.id]={id:o.id,refs:1,parts:a}}}}function r(t){for(var e=[],n={},o=0;o<t.length;o++){var r=t[o],i=r[0],a=r[1],s=r[2],u=r[3],l={css:a,media:s,sourceMap:u};n[i]?n[i].parts.push(l):e.push(n[i]={id:i,parts:[l]})}return e}function i(t,e){var n=m(),o=g[g.length-1];if("top"===t.insertAt)o?o.nextSibling?n.insertBefore(e,o.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),g.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){t.parentNode.removeChild(t);var e=g.indexOf(t);e>=0&&g.splice(e,1)}function s(t){var e=document.createElement("style");return e.type="text/css",i(t,e),e}function u(t){var e=document.createElement("link");return e.rel="stylesheet",i(t,e),e}function l(t,e){var n,o,r;if(e.singleton){var i=b++;n=y||(y=s(e)),o=c.bind(null,n,i,!1),r=c.bind(null,n,i,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(e),o=h.bind(null,n),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),o=f.bind(null,n),r=function(){a(n)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else r()}}function c(t,e,n,o){var r=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=x(e,r);else{var i=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function f(t,e){var n=e.css,o=e.media;if(o&&t.setAttribute("media",o),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function h(t,e){var n=e.css,o=e.sourceMap;o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var d={},p=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},v=p(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),m=p(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,b=0,g=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=v()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=r(t);return o(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var s=n[a],u=d[s.id];u.refs--,i.push(u)}if(t){var l=r(t);o(l,e)}for(var a=0;a<i.length;a++){var u=i[a];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete d[u.id]}}}};var x=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},186:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u);n(187);var c=3,f=5,h=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=n.props,a=o.index,s=o.children;return n.state={mode:"hide",lastIndex:a,currIndex:a,isDragging:!1},n.cardNum=s.length,n.startX=0,n.startY=0,n.vx=0,n.lastX=0,n.isStarted=!1,n.isSwiping=!1,n.handleTouchStart=n.handleTouchStart.bind(n),n.handleTouchMove=n.handleTouchMove.bind(n),n.handleTouchEnd=n.handleTouchEnd.bind(n),n.onTransitionEnd=n.onTransitionEnd.bind(n),n}return a(e,t),s(e,[{key:"handleTouchMove",value:function(t){if(!this.isStarted)return void this.handleTouchStart(t);var e=t.touches[0];if(!this.isSwiping){var n=Math.abs(this.startX-e.pageX),o=Math.abs(this.startY-e.pageY);n>o&&t.preventDefault();var r=n>o&&n>c;return void((1==r||o>c)&&(this.isSwiping=r,this.startX=e.pageX))}this.state.isDragging||this.setState({isDragging:!0}),t.preventDefault(),this.vx=.5*this.vx+.5*(e.pageX-this.lastX),this.lastX=e.pageX;var i=this.computeIndex({startX:this.startX,currX:e.pageX,cardNum:this.cardNum}),a=i.startX,s=i.index;this.setState({currIndex:s}),this.startX=a}},{key:"setMode",value:function(t){this.setState({mode:t})}},{key:"handleTouchStart",value:function(t){var e=t.touches[0];this.startX=e.pageX,this.startY=e.pageY,this.vx=0,this.lastX=e.pageX,this.isStarted=!0,this.isSwiping=!1}},{key:"handleTouchEnd",value:function(){if(this.isStarted&&(this.isStarted=!1,this.isSwiping)){var t=this.state,e=t.lastIndex,n=t.currIndex,o=void 0;o=this.vx>f?Math.floor(n):this.vx<-f?Math.ceil(n):Math.abs(e-n)>.6?Math.round(n):e,this.goTo(o)}}},{key:"goTo",value:function(t){var e=this.props.onChangeIndex,n=this.cardNum-1;t<0?t=0:t>n&&(t=n),this.setState({currIndex:t,lastIndex:t,isDragging:!1},function(n){e&&e(t)})}},{key:"computeIndex",value:function(t){var e=this.state.lastIndex,n=this.props.size.width,o=t.startX,r=t.currX,i=t.cardNum,a=i-1,s=e+(o-r)/n,u=o;return s<0&&(s=0,u=(s-e)*n+r),s>a&&(s=a,u=(s-e)*n+r),{startX:u,index:s}}},{key:"componentWillReceiveProps",value:function(t){var e=(t.size,t.index),n=t.children,o=this.props,r=(o.size,o.index),i=o.children;i!=n&&(this.cardNum=n.length),r!=e&&this.setState({lastIndex:e,currIndex:e})}},{key:"onTransitionEnd",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=this.props,e=t.size,n=t.children,o=e.width,r=e.height,i=this.state,a=i.mode,s=i.isDragging,u=i.currIndex,c="show"==a?"detail-show":"detail-hide",f=o*n.length,h=o*u,d=!s,p="translate3d(-"+h+"px,0,0)";return l.default.createElement("div",{className:"detail "+c,style:{width:o,height:r},ref:"detail"},l.default.createElement("div",{className:"detail-cover",onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,onTransitionEnd:this.onTransitionEnd}),l.default.createElement("div",{className:"detail-surface"+(d?" detail-surface-transition":""),style:{width:f,height:r,transform:p,WebkitTransform:p}},n.map(function(t,e){return l.default.createElement("div",{key:e,className:"detail-box-wrapper",style:{width:o,height:r,top:0,left:o*e}},t)})))}}]),e}(l.default.Component);e.default=h},187:function(t,e,n){var o=n(188);"string"==typeof o&&(o=[[t.id,o,""]]);n(185)(o,{});o.locals&&(t.exports=o.locals)},188:function(t,e,n){e=t.exports=n(184)(),e.push([t.id,".detail{position:fixed;top:0;left:0}.detail-cover{right:0;bottom:0;z-index:2;background:#fff;transition:opacity .8s linear}.detail-cover,.detail-surface{position:absolute;top:0;left:0}.detail-surface{will-change:transform;-webkit-transform:translateZ(0);transform:translateZ(0)}.detail-surface-transition{transition:transform .3s ease}.detail-box-wrapper{position:absolute}.detail-image-box{overflow:hidden;background:#00f;position:relative}.detail-image{display:block;transition:transform .8s ease-out .1s;position:absolute;top:50%;left:50%}.detail-caption{color:#fff;text-shadow:1px 1px 1px #666;line-height:1.4;z-index:1;padding:10px;overflow-x:hidden;overflow-y:auto}.detail-show{z-index:100;visibility:visible}.detail-hide{z-index:1;visibility:visible}.detail-show .detail-cover{opacity:0}.detail-hide .detail-cover{opacity:1}.detail-show .detail-image{-webkit-transform:scale(1.1);transform:scale(1.1)}.detail-hide .detail-image{-webkit-transform:scale(1);transform:scale(1)}",""])},189:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u),c=n(190),f=o(c),h=n(191),d=n(192),p=o(d),v=n(193),m=o(v),y=n(195),b=o(y),g=n(199),x=o(g),w=n(200),_=o(w),T=n(198),k=n(196),P={x:-8,y:0,z:120},E={x:.001,y:.001,z:.001
},I=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.frameId=null,n.renderFrames=n.renderFrames.bind(n),n.zoom=n.zoom.bind(n),n}return a(e,t),s(e,[{key:"renderFrames",value:function(){var t=this.scene,e=this.camera,n=this.webGLRenderer;n.render(t,e),f.default.update(),T.GlobalAnimations.update(),this.frameId=requestAnimationFrame(this.renderFrames)}},{key:"componentWillReceiveProps",value:function(t){var e=this,n=this.props,o=n.flatMap,r=n.currEventIdx,i=t.flatMap,a=t.currEventIdx,s=t.events,u=this.earthTweens;if(r!=a){var l=T.locations.getById(s[a].locId);this.sphereControl.autoFocus(l,50,i).start()}if(o!=i)if(i){var c=T.zoomFactor.get().value;(0,k.tweenChain)(this.sphereControl.autoRotate(0,0,0,0,500),u.toPlane.onUpdate(function(t){e.forceUpdateTrace()}),this.sphereControl.autoLocate(P).onUpdate(function(t){T.zoomFactor.set(c+t*(.35-c))})).onComplete(function(t){e.sphereControl._flag="FLAG_LOCATE"}).start()}else{var f=T.zoomFactor.get().value;(0,k.tweenChain)(this.sphereControl.autoLocate(E,500).onUpdate(function(t){T.zoomFactor.set(f+t*(1-f))}),u.toSphere.onUpdate(function(t){e.forceUpdateTrace()})).onComplete(function(t){e.sphereControl._flag="FLAG_ROTATE"}).start()}}},{key:"zoom",value:function(t){var e=this.props,n=e.events,o=e.currEventIdx,r=e.flatMap,i=this.refs.space,a=this.sphereControl,s="FLAG_LOCATE"==a._flag,u=T.locations.getById(n[o].locId),l=50;return t?(0,k.tweenChain)(a.autoFocus(u,l,r,!0),a.autoLocate({z:s?200:100},null,!0).onComplete(function(t){i.style.display="none"})):a.autoLocate({z:s?P.z:E.z},null,!0).onUpdate(function(t){s||T.zoomFactor.setByZ(a.object.position.z)}).onStart(function(t){i.style.display="block"})}},{key:"componentDidMount",value:function(){var t=this,e=this.props,n=e.events,o=e.currEventIdx;this.webGLRenderer=new h.WebGLRenderer({antialias:!0,canvas:this.canvas}),this.sphereControl.bind(this.canvas),T.GlobalAnimations.add(this.sphereControl),this.renderFrames();var r=T.locations.getById(n[o].locId),i=r.lat,a=r.lon;this.sphereControl.openTween(.01,.3,800).onComplete(function(e){t.sphereControl.autoRotate(i,a,0,.002).start()}).start()}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.frameId),this.sphereControl.unbind(this.canvas),T.GlobalAnimations.remove(this.sphereControl)}},{key:"render",value:function(){var t=this,e=this.props,n=e.width,o=e.height,r=e.top,i=e.events,a=e.currEventIdx,s=0,u=120,c=-150;return l.default.createElement("div",{className:"space",style:{width:n,height:o,top:r,left:0},ref:"space"},l.default.createElement(p.default,{ref:function(e){e&&(t.scene=e.obj,t.canvas=e.refs.canvas)},width:n,height:o,style:{display:"block",margin:0}},l.default.createElement(m.default,{ref:function(e){e&&(t.camera=e.obj)},fov:80,aspect:n/o,near:.5,far:250,z:150}),l.default.createElement(b.default,{x:s,y:u,z:c,ref:function(e){e&&(t.sphereControl=e.control)}},l.default.createElement(x.default,{radius:50,ref:function(e){e&&(t.earthTweens=e.earthTweens)}}),l.default.createElement(_.default,{radius:50,events:i,currEventIdx:a,ref:function(e){e&&(t.forceUpdateTrace=e.forceUpdate)}}))))}}]),e}(l.default.Component);e.default=I},190:function(t,e){void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var n=n||function(){var t=[];return{REVISION:"8",getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var n=t.indexOf(e);n!==-1&&t.splice(n,1)},update:function(e){if(0===t.length)return!1;var n=0,o=t.length;for(e=void 0!==e?e:Date.now();n<o;)t[n].update(e)?n++:(t.splice(n,1),o--);return!0}}}();n.Tween=function(t){var e=t,o={},r={},i=1e3,a=0,s=null,u=n.Easing.Linear.None,l=n.Interpolation.Linear,c=[],f=[],h=!1,d=[],p=[];this.to=function(t,e){return void 0!==e&&(i=e),r=t,this},this.start=function(t){n.add(this),h=!1,s=void 0!==t?t:Date.now(),s+=a;for(var i in r)if(null!==e[i]&&i in e){if(r[i]instanceof Array){if(0===r[i].length)continue;r[i]=[e[i]].concat(r[i])}o[i]=e[i]}return this},this.stop=function(){return n.remove(this),this},this.delay=function(t){return a=t,this},this.easing=function(t){return u=t,this},this.interpolation=function(t){return l=t,this},this.chain=function(){return c=arguments,this},this.onStart=function(t){return f.push(t),this},this.onUpdate=function(t){return d.push(t),this},this.onComplete=function(t){return p.push(t),this},this.update=function(t){if(t<s)return!0;h===!1&&(0!==f.length&&f.forEach(function(t){t.call(e)}),h=!0);var n=(t-s)/i;n=n>1?1:n;var a=u(n);for(var v in o){var m=o[v],y=r[v];y instanceof Array?e[v]=l(y,a):e[v]=m+(y-m)*a}if(0!==d.length&&d.forEach(function(t){t.call(e,a)}),1==n){0!==p.length&&p.forEach(function(t){t.call(e)});for(var b=0,g=c.length;b<g;b++)c[b].start(t);return!1}return!0}},n.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,n=.1,o=.4;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=o/4):e=o*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/o)))},Out:function(t){var e,n=.1,o=.4;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=o/4):e=o*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/o)+1)},InOut:function(t){var e,n=.1,o=.4;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=o/4):e=o*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?-.5*(n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/o)):n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/o)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-n.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*n.Easing.Bounce.In(2*t):.5*n.Easing.Bounce.Out(2*t-1)+.5}}},n.Interpolation={Linear:function(t,e){var o=t.length-1,r=o*e,i=Math.floor(r),a=n.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],r):e>1?a(t[o],t[o-1],o-r):a(t[i],t[i+1>o?o:i+1],r-i)},Bezier:function(t,e){var o,r=0,i=t.length-1,a=Math.pow,s=n.Interpolation.Utils.Bernstein;for(o=0;o<=i;o++)r+=a(1-e,i-o)*a(e,o)*t[o]*s(i,o);return r},CatmullRom:function(t,e){var o=t.length-1,r=o*e,i=Math.floor(r),a=n.Interpolation.Utils.CatmullRom;return t[0]===t[o]?(e<0&&(i=Math.floor(r=o*(1+e))),a(t[(i-1+o)%o],t[i],t[(i+1)%o],t[(i+2)%o],r-i)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-r)-t[0]):e>1?t[o]-(a(t[o],t[o],t[o-1],t[o-1],r-o)-t[o]):a(t[i?i-1:0],t[i],t[o<i+1?o:i+1],t[o<i+2?o:i+2],r-i)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var o=n.Interpolation.Utils.Factorial;return o(t)/o(e)/o(t-e)},Factorial:function(){var t=[1];return function(e){var n,o=1;if(t[e])return t[e];for(n=e;n>1;n--)o*=n;return t[e]=o}}(),CatmullRom:function(t,e,n,o,r){var i=.5*(n-t),a=.5*(o-e),s=r*r,u=r*s;return(2*e-2*n+i+a)*u+(-3*e+3*n-2*i-a)*s+i*r+e}}},t.exports=n},192:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u),c=n(191),f=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.obj=new c.Scene,n}return a(e,t),s(e,[{key:"render",value:function(){var t=this.props,e=t.width,n=t.height,o=t.style;return l.default.createElement("canvas",{ref:"canvas",width:e,height:n,style:o},this.props.children)}},{key:"getChildContext",value:function(){return{parent:this.obj}}}]),e}(l.default.Component);f.childContextTypes={parent:l.default.PropTypes.object},e.default=f},193:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(191),l=n(194),c=o(l),f=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"objContructor",value:function(t){var e=t.fov,n=t.aspect,o=t.near,r=t.far,i=t.z,a=new u.PerspectiveCamera(e,n,o,r);return a.position.z=i,a}},{key:"render",value:function(){return null}}]),e}(c.default);c.default.setTypes(f,{hasChild:!1}),e.default=f},194:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u),c=n(191),f=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.obj=n.objContructor(t),n}return a(e,t),s(e,[{key:"componentWillReceiveProps",value:function(t){this.objWillReceiveProps(t)}},{key:"componentDidMount",value:function(){var t=this.context.parent;t.add(this.obj),this.objDidMount()}},{key:"componentWillUnmount",value:function(){var t=this.context.parent;t.remove(this.obj),this.objWillUnmount()}},{key:"render",value:function(){return l.default.createElement("span",null,this.props.children)}},{key:"getChildContext",value:function(){return{parent:this.obj}}},{key:"objContructor",value:function(t){return new c.Object3D}},{key:"objWillReceiveProps",value:function(t){}},{key:"objDidMount",value:function(){}},{key:"objWillUnmount",value:function(){}}]),e}(l.default.Component);f.setTypes=function(t,e){e=e||{},e.hasChild&&(t.childContextTypes={parent:l.default.PropTypes.object}),t.contextTypes={parent:l.default.PropTypes.object}},f.setTypes(f,{hasChild:!0}),e.default=f},195:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(194),l=o(u),c=n(196),f=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"objDidMount",value:function(){var t=this.props,e=t.x,n=t.y,o=t.z,r=this.obj;r.position.x=e||0,r.position.y=n||0,r.position.z=o||0,this.control=new c.SphereControl(r)}}]),e}(l.default);l.default.setTypes(f,{hasChild:!0}),e.default=f},196:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n,o,r){var i=n*e/360,a=o*t/180;return new u.Vector3(i,a,r)}Object.defineProperty(e,"__esModule",{value:!0}),e.mixVector3=e.tweenChain=e.clamp=e.toFloatString=e.getPlanePos=e.getCartesianPos=e.SphereControl=void 0;var i=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(190),s=o(a),u=n(191),l=n(197),c=o(l),f=Math.PI/180,h=function(t,e,n){var o=Math.PI/2-t*f,r=Math.PI/2-e*f,i=n*Math.sin(o)*Math.cos(r),a=n*Math.cos(o),s=n*Math.sin(o)*Math.sin(r);return new u.Vector3(i,a,s)},d=function(t,e,n){var o=(1-n)*t.x+n*e.x,r=(1-n)*t.y+n*e.y,i=(1-n)*t.z+n*e.z;return new u.Vector3(o,r,i)},p=function(t){return(t+"").split(".").concat(0).slice(0,2).join(".")},v=function(t,e,n){var o=e>n?[n,e]:[e,n],r=i(o,2);return e=r[0],n=r[1],Math.min(n,Math.max(e,t))},m=function(t){if(t=t||{},t instanceof s.default.Tween)return t;var e=t.easing||s.default.Easing.Back.Out,n=t.duration||500,o=t.onComplete||function(){},r=t.onUpdate||function(){},i=t.onStart||function(){};return new s.default.Tween(t.ref).to(t.to,n).easing(e).onStart(i).onUpdate(r).onComplete(o)},y=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var o=m(e.pop()),r=0,i=e.length;r<i;r++)o=m(e[i-1-r]).chain(o);return o};e.SphereControl=c.default,e.getCartesianPos=h,e.getPlanePos=r,e.toFloatString=p,e.clamp=v,e.tweenChain=y,e.mixVector3=d},197:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(190),s=o(a),u=n(196),l=n(198),c=s.default.Easing.Back.Out,f=s.default.Easing.Quadratic.Out,h=Math.PI/180,d=2*Math.PI,p=90*Math.PI/180,v=-55,m=16,y=-33,b=10,g=0,x=90,w=0,_=1,T=2,k=3,P="FLAG_ROTATE",E="FLAG_LOCATE",I=function(){function t(e,n){r(this,t),this.object=e,this._state=w,this._flag=P;var o=[0,0,0,0,0,0,0,0];this._startX=o[0],this._startY=o[1],this._currX=o[2],this._currY=o[3],this._prevX=o[4],this._prevY=o[5],this._currPinchDist=o[6],this._prevPinchDist=o[7];var i=[0,0];this._rotateX=i[0],this._rotateY=i[1];var a=[0,0];this._rotateVx=a[0],this._rotateVy=a[1];var s=[0,0,0];this._locateX=s[0],this._locateY=s[1],this._locateZ=s[2];var u=[0,0,0];this._locateVx=u[0],this._locateVy=u[1],this._locateVz=u[2],this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),n&&this.bind(n)}return i(t,[{key:"bind",value:function(t){t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1)}},{key:"unbind",value:function(t){t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd)}},{key:"onTouchStart",value:function(t){if(this._state!=k){if(this._flag==E)return this._state=_,this._startX=t.touches[0].clientX,this._startY=t.touches[0].clientY,this._currX=t.touches[0].clientX,void(this._currY=t.touches[0].clientY);if(1==t.touches.length&&(this._state=_,this._startX=t.touches[0].clientX,this._startY=t.touches[0].clientY,this._currX=t.touches[0].clientX,this._currY=t.touches[0].clientY),2==t.touches.length){this._state=T;var e=t.touches[0],n=e.clientX,o=e.clientY,r=t.touches[1],i=r.clientX,a=r.clientY,s=i-n,u=a-o;this._currPinchDist=Math.sqrt(s*s+u*u)}}}},{key:"onTouchMove",value:function(t){if(this._state==_||this._state==T){if(t.preventDefault(),t.stopPropagation(),this._flag==E)return this._prevX=this._currX,this._prevY=this._currY,this._currX=t.touches[0].clientX,this._currY=t.touches[0].clientY,this._locateVx+=(this._currX-this._prevX)/2*.1,void(this._locateVy-=(this._currY-this._prevY)/2*.1);if(1==t.touches.length&&(this._prevX=this._currX,this._prevY=this._currY,this._currX=t.touches[0].clientX,this._currY=t.touches[0].clientY,this._rotateVx+=(this._currY-this._prevY)/2*h*.5,this._rotateVy+=(this._currX-this._prevX)/2*h*.5),2==t.touches.length){this._prevPinchDist=this._currPinchDist;var e=t.touches[0],n=e.clientX,o=e.clientY,r=t.touches[1],i=r.clientX,a=r.clientY,s=i-n,c=a-o;this._currPinchDist=Math.sqrt(s*s+c*c),this.locateVz=.3*(this._currPinchDist-this._prevPinchDist);var f=this.object,d=(0,u.clamp)(f.position.z+this.locateVz,g,x);f.position.z=d,l.zoomFactor.setByZ(d)}}}},{key:"onTouchEnd",value:function(t){this._state!=k&&(this._state=w)}},{key:"setRotateV",value:function(t,e){this._rotateVx=t||0,this._rotateVy=e||0}},{key:"openTween",value:function(t,e,n){this._rotateVx=t,this._rotateVy=e;this.object;return this.autoLocate({x:.001,y:.001,z:.001},n,!0)}},{key:"autoLocate",value:function(t,e,n){var o=this,r=o.object,i=r.position.x,a=r.position.y,u=r.position.z,l=t.hasOwnProperty("x")?t.x:i,c=t.hasOwnProperty("y")?t.y:a,h=t.hasOwnProperty("z")?t.z:u;n||(this._state=k),e=e||Math.max(500,5*Math.sqrt((l-i)*(l-i)+(c-a)*(c-a)+(h-u)*(h-u)));var d=new s.default.Tween(r.position).to(t,e).easing(f).onComplete(function(){o._state=w});return d}},{key:"autoRotate",value:function(t,e,n,o,r){t=t||0,e=e||0,n=n||0,o=o||0,this._state=k;var i=this,a=this.object,u=a.rotation.x,l=a.rotation.y,f=t*h,d=-e*h;r=r||Math.max(500,200*Math.sqrt((f-u)*(f-u)+(d-l)*(d-l)));var p=new s.default.Tween(a.rotation).to({x:f,y:d},r).easing(c).onComplete(function(){i.setRotateV(n,o),i._state=w});return p}},{key:"autoFocus",value:function(t,e,n,o){var r=t.lat,i=t.lon,a=(0,u.getPlanePos)(r,i,4*e,2*e,0),s=a.x,l=a.y,c=this.object.position,f=c.x,h=c.y;if(n){if(o)return this.autoLocate({x:-s,y:-l});var d=.6*e,p=s-f,v=l-h,m=Math.sqrt(p*p+v*v);if(m>d){var y=-s,b=-l;return this.autoLocate({x:y,y:b})}return this.autoLocate({x:f,y:h},1)}return this.autoRotate(r,i,0,0)}},{key:"update",value:function(){if(this._state!=k){var t=this.object;this._flag==E&&(this._locateX=t.position.x,this._locateY=t.position.y,this._locateX+=this._locateVx,this._locateY+=this._locateVy,this._locateVx*=.98,this._locateVy*=.98,this._state==_&&(this._locateVx*=.7,this._locateVy*=.7),this._locateX<v&&(this._locateX=v,this._locateVx=0),this._locateX>m&&(this._locateX=m,this._locateVx=0),this._locateY<y&&(this._locateY=y,this._locateVy=0),this._locateY>b&&(this._locateY=b,this._locateVy=0),t.position.x=this._locateX,t.position.y=this._locateY),this._flag==P&&(this._rotateX=t.rotation.x,this._rotateY=t.rotation.y,this._rotateX+=this._rotateVx,this._rotateY+=this._rotateVy,this._rotateX=this._rotateX%d,this._rotateY=this._rotateY%d,this._rotateVx*=.98,this._rotateVy*=.98,this._state==_&&(this._rotateVx*=.6,this._rotateVy*=.6),this._rotateX<-p&&(this._rotateX=-p,this._rotateVx*=-.95),this._rotateX>p&&(this._rotateX=p,this._rotateVx*=-.95),t.rotation.x=this._rotateX,t.rotation.y=this._rotateY)}}}]),t}();e.default=I},198:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){var e={value:0},n=function(t){return e},o=function(t){e.value=t};return{get:n,set:o}}(),o=function(t){var e={value:1},n=function(t){return e},o=function(t){e.value=t},r=function(t){e.value=1-t/120};return{get:n,set:o,setByZ:r}}(),r=function(t){var e={1:{lat:17.2705078125,lon:-11.42578125,cn:"君临城",en:"King's Landing"},2:{lat:44.208984375,lon:-16.3037109375,cn:"临冬城",en:"Winterfell"},3:{lat:19.775390625,lon:-25.7958984375,cn:"凯岩城",en:"Casterly Rock"},4:{lat:24.2138671875,lon:-18.544921875,cn:"奔流城",en:"Riverrun"},5:{lat:27.24609375,lon:-9.580078125,cn:"鹰巢城",en:"Eyrie"},6:{lat:12.12890625,lon:-6.8115234375,cn:"风息堡",en:"Storm's End"},7:{lat:2.109375,lon:-4.2626953125,cn:"阳戟城",en:"Sunspear"},8:{lat:26.455078125,lon:-25.576171875,cn:"派克城",en:"Pyke"},9:{lat:54.0966796875,lon:-11.9091796875,cn:"黑堡",en:"Castle Black"},10:{lat:20.6103515625,lon:-5.4052734375,cn:"龙石岛",en:"Dragonstone"},11:{lat:21.4453125,lon:57.8759765625,cn:"多斯拉克(马王城)",en:"Vaes Dothrak"},12:{lat:31.2890625,lon:3.2958984375,cn:"布拉佛斯城邦",en:"Braavos"},13:{lat:17.75390625,lon:3.6474609375,cn:"潘托斯城邦",en:"Pentos"},14:{lat:1.58203125,lon:17.75390625,cn:"瓦兰提斯城邦",en:"Volantis"},15:{lat:-1.0546875,lon:39.4189453125,cn:"阿斯塔波",en:"Astapor"},16:{lat:3.69140625,lon:40.60546875,cn:"渊凯",en:"Yunkai"},17:{lat:5.712890625,lon:42.71484375,cn:"弥林",en:"Meereen"},18:{lat:-7.03125,lon:65.3466796875,cn:"奎尔斯城",en:"Qarth"},19:{lat:16.0400390625,lon:61.69921875,cn:"多斯拉克东南部",en:"SE of Dothrak"},20:{lat:13.6669921875,lon:62.75390625,cn:"多斯拉克东南部",en:"SE of Dothrak"},21:{lat:-1.142578125,lon:58.7109375,cn:"红色荒原",en:"Red Waste"},22:{lat:-7.03125,lon:26.5869140625,cn:"瓦雷利亚荒城",en:"Valyria"},23:{lat:13.974609375,lon:40.2958984375,cn:"多斯拉克草原",en:"Dothraki Sea"},24:{lat:10.2705078125,lon:0,cn:"狭海之上",en:"Narrow sea"},25:{lat:26.015625,lon:-13.798828125,cn:"十字路口客栈",en:"Inn at the crossroads"},26:{lat:26.015625,lon:-11.2060546875,cn:"明月山脉",en:"Mountains of the Moon"},27:{lat:24.8291015625,lon:-13.88671875,cn:"三叉戟河",en:"Trident"},28:{lat:7.3828125,lon:-17.666015625,cn:"极乐塔",en:"Tower of Joy"},29:{lat:10.01953125,lon:-22.236328125,cn:"高庭",en:"Highgarden"},30:{lat:55.72265625,lon:-13.2275390625,cn:"卡斯特堡",en:"Caster's Keep"},31:{lat:56.6015625,lon:-16.3037109375,cn:"风声峡",en:"Skirling Pass"},32:{lat:58.798828125,lon:-13.0078125,cn:"野人营地",en:"Camp of the wildlings"},33:{lat:57.7880859375,lon:-8.3935546875,cn:"艰难屯",en:"Hardhome"}},n=function(t){return e[t]};return{getById:n}}(),i=function(){var t=[];return{add:function(e){var n=!e.tag||t.map(function(t){return t.tag||""}).indexOf(e.tag)==-1;n&&t.push(e)},remove:function(e){var n;n="string"==typeof e?t.map(function(t){return t.tag||""}).indexOf(e):t.indexOf(e),n!==-1&&t.splice(n,1)},update:function(){t.forEach(function(t){t.update()})}}}();e.GlobalAnimations=i,e.mixAmountEarthShape=n,e.zoomFactor=o,e.locations=r},199:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(194),l=o(u),c=n(191),f=n(190),h=o(f),d=n(198),p=h.default.Easing.Back.Out,v=(h.default.Easing.Quadratic.Out,new c.TextureLoader),m=new c.Texture(R.getImage("img_map"));m.needsUpdate=!0;var y={uniforms:{mixAmount:d.mixAmountEarthShape.get(),mixTexture:{value:.5},texture:{value:m},texture2:{value:m}},vertexShader:["varying vec3 vNormal;","varying vec2 vUv;","attribute vec3 position2;","attribute vec3 normal2;","uniform float mixAmount;","void main() {","vec3 newPos = mix(position, position2, mixAmount);","vec3 newNorm = mix(normal, normal2, mixAmount);","gl_Position = projectionMatrix * modelViewMatrix * vec4( newPos, 1.0 );","vNormal = normalize( normalMatrix * newNorm );","vUv = uv;","}"].join("\n"),fragmentShader:["uniform float mixTexture;","uniform sampler2D texture;","uniform sampler2D texture2;","varying vec3 vNormal;","varying vec2 vUv;","void main() {","vec3 diffuse = texture2D( texture, vUv ).xyz;","vec3 diffuse2 = texture2D( texture2, vUv ).xyz;","vec3 rgb = mix(diffuse, diffuse2, mixTexture);","float intensity = 1.05 - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) );","vec3 atmosphere = vec3( 1.0, 1.0, 1.0 ) * pow( intensity, 3.0 );","gl_FragColor = vec4( rgb + atmosphere, 1.0 );","}"].join("\n")},b=function(t){var e=new c.SphereBufferGeometry(t,32,32);e.rotateY(-Math.PI/2);var n=new c.PlaneBufferGeometry(4*t,2*t,32,32),o=new c.BufferGeometry;o.addAttribute("position",e.getAttribute("position")),o.addAttribute("normal",e.getAttribute("normal")),o.addAttribute("position2",n.getAttribute("position")),o.addAttribute("normal2",n.getAttribute("normal")),o.addAttribute("uv",n.getAttribute("uv")),o.setIndex(n.getIndex());var r=new c.ShaderMaterial(y),i=new c.Mesh(o,r);return i.name="earth",i},g=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"objContructor",value:function(t){var e=t.radius;return b(e)}},{key:"objWillReceiveProps",value:function(t){var e=this.props.map,n=t.map,o=this.obj;n&&e!=n&&v.load(n,function(t){t.needsUpdate=!0,o.material.uniforms.texture.value=o.material.uniforms.texture2.value,o.material.uniforms.texture2.value=t;var e=o.material.uniforms.mixTexture;e.value=0,new h.default.Tween(e).to({value:1},600).easing(h.default.Easing.Linear.None).start()})}},{key:"shouldComponentUpdate",value:function(t,e){var n=this.props,o=n.radius,r=n.map,i=t.radius,a=t.map;return r!=a||o!=i}},{key:"objDidMount",value:function(){var t=this.props.map;this.obj;this.earthTweens={toPlane:new h.default.Tween(d.mixAmountEarthShape.get()).to({value:1},500).easing(p),toSphere:new h.default.Tween(d.mixAmountEarthShape.get()).to({value:0},500).easing(p)},t&&v.load(t,function(t){t.needsUpdate=!0})}},{key:"render",value:function(){return null}}]),e}(l.default);l.default.setTypes(g,{hasChild:!1}),e.default=g},200:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=n(191),c=n(190),f=o(c),h=n(196),d=n(198),p=n(3),v=o(p),m=n(194),y=o(m),b=function(t){var e=document.createElement("canvas"),n=e.getContext("2d");e.width=e.height=16;var o=e.width/2,r=e.height/2,i=o,a=r,s=e.width/2,u=n.createRadialGradient(o,r,0,i,a,s);return u.addColorStop(0,"rgba(255,255,255,1)"),u.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=u,n.fillRect(0,0,e.width,e.height),e}(),g=new l.Texture(b);g.needsUpdate=!0;var x=function(t){var e=64,n=512,o=document.createElement("canvas"),r=o.getContext("2d");return o.width=n,o.height=e,r.font="Bold 48px Arial",r.textBaseline="middle",r.textAlign="center",r.fillStyle="rgba(255,255,255,1)",o}(),w=new l.Texture(x);w.needsUpdate=!0;var _={uniforms:{mixAmount:d.mixAmountEarthShape.get(),p0:{value:new l.Vector3(0,0,0)},p1:{value:new l.Vector3(0,0,0)},p2:{value:new l.Vector3(0,0,0)},p0_:{value:new l.Vector3(0,0,0)},p1_:{value:new l.Vector3(0,0,0)},p2_:{value:new l.Vector3(0,0,0)},t:{value:1},twinkle:{value:0},texture:{value:g},color:{value:new l.Vector3(1,0,0)}},vertexShader:["#define PI2 6.28318530718","uniform vec3 p0;","uniform vec3 p1;","uniform vec3 p2;","uniform vec3 p0_;","uniform vec3 p1_;","uniform vec3 p2_;","uniform float t;","uniform float mixAmount;","uniform float twinkle;","void main() {","vec3 p = (1.0 - t)*(1.0 - t)*p0 + 2.0*t*(1.0-t)*p1 + t*t*p2;","vec3 p_ = (1.0 - t)*(1.0 - t)*p0_ + 2.0*t*(1.0-t)*p1_ + t*t*p2_;","vec3 pos = mix(p, p_, mixAmount);","vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);","gl_PointSize = (0.75 + 0.25*cos(twinkle*PI2)) * 20.0;","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","uniform vec3 color;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec4 diffuseColor = vec4(color, 1.0)*texture2D( texture, gl_PointCoord );","#ifdef ALPHATEST","if ( diffuseColor.a < ALPHATEST ) discard;","#endif","gl_FragColor = diffuseColor ;","}"].join("\n"),
transparent:!0,blending:l.NormalBlending,alphaTest:.01,depthTest:!0},T={uniforms:{mixAmount:d.mixAmountEarthShape.get(),startIdx:{value:0},endIdx:{value:0},highRatio:{value:0},baseColor:{value:new l.Vector3(1,0,0)},highColor:{value:new l.Vector3(1,1,0)}},vertexShader:["uniform float mixAmount;","attribute vec3 position2;","attribute float idx;","varying float vIdx;","void main() {","vIdx = idx;","vec3 newPos = mix(position, position2, mixAmount);","vec4 mvPosition = modelViewMatrix * vec4( newPos, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float startIdx;","uniform float endIdx;","uniform float highRatio;","uniform vec3 baseColor;","uniform vec3 highColor;","varying float vIdx;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","float highIdx = startIdx - 10.0 + highRatio*(endIdx - startIdx + 20.0);","float mask_alpha = clamp(vIdx -startIdx + 1.0, 0.0, 1.0)*clamp(endIdx - vIdx + 1.0, 0.0, 1.0);","float mask1 = clamp(highIdx - vIdx, 0.0, 1.0);","float mask2 = 1.0 - mask1;","float r1 = clamp((vIdx - startIdx)/(highIdx - startIdx), 0.0, 1.0);","float r2 = clamp((endIdx - vIdx)/(endIdx - highIdx), 0.0, 1.0);","vec3 cb = rgb2hsv(baseColor);","vec3 ch = rgb2hsv(highColor);","vec3 c = mix(cb, ch, r1)*mask1 + mix(cb, ch, r2)*mask2;","vec3 cc = hsv2rgb(c);","gl_FragColor = vec4(cc, 1.0*mask_alpha);","}"].join("\n"),transparent:!0,depthTest:!0},k={uniforms:{mixAmount:d.mixAmountEarthShape.get(),texture:{value:g},color:{value:new l.Vector3(1,.7,.3)}},vertexShader:["uniform float mixAmount;","attribute vec3 position2;","void main() {","vec3 pos = mix(position, position2, mixAmount);","vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);","gl_PointSize = 8.0;","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","uniform vec3 color;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec4 diffuseColor = vec4(color, 1.0)*texture2D( texture, gl_PointCoord );","#ifdef ALPHATEST","if ( diffuseColor.a < ALPHATEST ) discard;","#endif","gl_FragColor = diffuseColor ;","}"].join("\n"),transparent:!0,blending:l.NormalBlending,alphaTest:.01,depthTest:!1},P={uniforms:{zoomFactor:d.zoomFactor.get(),texture:{value:w},color:{value:new l.Vector3(1,1,1)}},vertexShader:["#define PI2 6.28318530718","uniform float zoomFactor;","varying vec2 vUv;","void main() {","vUv = uv;","float rotation = 0.0;","vec3 alignedPosition = position * 6.0*max(0.0, zoomFactor);","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","uniform vec3 color;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( texture, vUv );","vec4 diffuseColor = vec4(color*tex.xyz, tex.a);","gl_FragColor = diffuseColor ;","}"].join("\n"),transparent:!0,blending:l.NormalBlending,depthTest:!0},E=function(t,e){var n=.01,o=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),r=t.x-e.x,i=t.y-e.y,a=t.z-e.z,s=Math.sqrt(r*r+i*i+a*a),u=o*(1+s*n),c=(t.x+e.x)/2,f=(t.y+e.y)/2,h=(t.z+e.z)/2,d=Math.sqrt(c*c+f*f+h*h),p=u/d;return new l.Vector3(p*c,p*f,p*h)},I=function(t,e){var n=.2,o=t.x-e.x,r=t.y-e.y,i=t.z-e.z,a=Math.sqrt(o*o+r*r+i*i),s=(t.x+e.x)/2,u=(t.y+e.y)/2,c=a*n;return new l.Vector3(s,u,c)},O=function(t,e){var n=.5,o=t.x-e.x,r=t.y-e.y,i=t.z-e.z,a=Math.sqrt(o*o+r*r+i*i);return Math.max(Math.round(a*n),3)},M=function(t,e){for(var n=e.map(function(e){var n=d.locations.getById(e.locId),o=n.lat,r=n.lon;return(0,h.getCartesianPos)(o,r,t)}),o=e.map(function(e){var n=d.locations.getById(e.locId),o=n.lat,r=n.lon;return(0,h.getPlanePos)(o,r,4*t,2*t,0)}),r=[],i=[],a=[],s=0;s<n.length-1;s++){var u=n[s],c=n[s+1],f=E(u,c),p=o[s],v=o[s+1],m=I(p,v),y=O(p,v),b=new l.QuadraticBezierCurve3(u,f,c);i=[].concat.apply(i,b.getPoints(y).map(function(t){return[t.x,t.y,t.z]}));var g=new l.QuadraticBezierCurve3(p,m,v);a=[].concat.apply(a,g.getPoints(y).map(function(t){return[t.x,t.y,t.z]})),r.push(i.length/3-1)}return r.unshift(0),i=new Float32Array(i),a=new Float32Array(a),[r,i,a,n,o]},C=function(t,e,n){var o=function(){for(var e=[],n=0,o=t.length/3;n<o;n++)e.push(n);return e}(),r=new Float32Array(o),i=new l.BufferGeometry;i.addAttribute("position",new l.BufferAttribute(t,3)),i.addAttribute("position2",new l.BufferAttribute(e,3)),i.addAttribute("idx",new l.BufferAttribute(r,1)),T.uniforms.endIdx.value=n;var a=new l.ShaderMaterial(T),s=new l.Line(i,a),u=new f.default.Tween(T.uniforms.highRatio).to({value:1},1500),c=new f.default.Tween(T.uniforms.highRatio).to({value:0},1);return u.chain(c),c.chain(u),u.start(),s},S=function(t,e){var n=[].concat.apply([],t.map(function(t){return[t.x,t.y,t.z]})),o=[].concat.apply([],e.map(function(t){return[t.x,t.y,t.z]}));n=new Float32Array(n),o=new Float32Array(o);var r=new l.BufferGeometry;r.addAttribute("position",new l.BufferAttribute(n,3)),r.addAttribute("position2",new l.BufferAttribute(o,3));var i=new l.ShaderMaterial(k),a=new l.Points(r,i);return a},j=function(t,e){_.uniforms.p0.value=new l.Vector3(0,0,0),_.uniforms.p1.value=new l.Vector3(0,0,0),_.uniforms.p2.value=t,_.uniforms.p0_.value=new l.Vector3(0,0,0),_.uniforms.p1_.value=new l.Vector3(0,0,0),_.uniforms.p2_.value=e,_.uniforms.t.value=1;var n=new l.BufferGeometry;n.addAttribute("position",new l.BufferAttribute(new Float32Array([0,0,-50]),3));var o=new l.ShaderMaterial(_),r=new l.Points(n,o),i=new f.default.Tween(_.uniforms.twinkle).to({value:1},800),a=new f.default.Tween(_.uniforms.twinkle).to({value:0},1);return i.chain(a),a.chain(i),i.start(),r},z=function(t,e,n){var o=new l.PlaneBufferGeometry(8,1),r=new l.ShaderMaterial(P),i=new l.Mesh(o,r),a=r.uniforms.texture.value,s=a.image,u=s.getContext("2d"),c=s.width,f=s.height;i.setPosition=function(t,e){var n=t.x,o=t.y,r=t.z,a=e.x,s=e.y,u=e.z,l=d.mixAmountEarthShape.get().value,c=d.zoomFactor.get().value,f=(o<0?-6:6)*c,p=4,v=1,m=(0,h.mixVector3)({x:n,y:o+f,z:r},{x:a,y:s+p,z:u+v},l);i.position.x=m.x,i.position.y=m.y,i.position.z=m.z},i.fillText=function(t){u.clearRect(0,0,c,f),u.fillText(t,c/2,f/2),a.needsUpdate=!0};var p=null;return i.blink=function(t){clearTimeout(p),i.visible=!1,p=setTimeout(function(t){i.visible=!0},500)},i.setPosition(t,e),i.fillText(n),i},B=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"objContructor",value:function(t){var e=t.vertices,n=t.vertices_,o=t.endVertex;return C(e,n,o)}},{key:"componentDidUpdate",value:function(t,e){var n=this.props.endVertex,o=t.endVertex;if(o!=n){var r=new f.default.Tween(T.uniforms.endIdx).to({value:n},500);r.start()}}},{key:"render",value:function(){return null}}]),e}(y.default),A=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"objContructor",value:function(t){var e=t.ps,n=t.ps_;return S(e,n)}},{key:"render",value:function(){return null}}]),e}(y.default),R=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"objContructor",value:function(t){var e=t.p,n=t.p_;return j(e,n)}},{key:"componentDidUpdate",value:function(t,e){var n=this.props,o=n.p,r=n.p_,i=t.p,a=t.p_,s=E(i,o),u=I(a,r);if(i!=o){_.uniforms.p0.value=i,_.uniforms.p1.value=s,_.uniforms.p2.value=o,_.uniforms.p0_.value=a,_.uniforms.p1_.value=u,_.uniforms.p2_.value=r,_.uniforms.t.value=0;var l=new f.default.Tween(_.uniforms.t).to({value:1},500);l.start()}}},{key:"render",value:function(){return null}}]),e}(y.default),X=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),u(e,[{key:"objContructor",value:function(t){var e=t.p,n=t.p_,o=t.title;return this.forceUpdate=this.forceUpdate.bind(this),z(e,n,o)}},{key:"forceUpdate",value:function(){var t=this.props,e=t.p,n=t.p_,o=this.obj;o.setPosition(e,n)}},{key:"componentDidUpdate",value:function(t,e){var n=this.props,o=n.p,r=n.p_,i=n.title,a=t.p,s=this.obj;a!=o&&(s.blink(),s.setPosition(o,r),s.fillText(i))}},{key:"render",value:function(){return null}}]),e}(y.default),N=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=t.radius,a=t.events,u=t.currEventIdx,l=M(o,a),c=s(l,5),f=c[0],h=c[1],p=c[2],v=c[3],m=c[4];n.endVertices=f,n.vertices=h,n.vertices_=p,n.ps=v,n.ps_=m,n.forceUpdate=n.forceUpdate.bind(n);var y=f[u],b=d.locations.getById(a[u].locId).cn,g=v[u],x=m[u];return n.state={endVertex:y,p:g,p_:x,title:b},n}return a(e,t),u(e,[{key:"forceUpdate",value:function(){this.forceUpdateLandmark()}},{key:"componentWillReceiveProps",value:function(t){var e=this.props.currEventIdx,n=t.currEventIdx,o=t.events;if(e!=n){var r=this.endVertices[n],i=d.locations.getById(o[n].locId).cn,a=this.ps[n],s=this.ps_[n];this.setState({endVertex:r,p:a,p_:s,title:i})}}},{key:"render",value:function(){var t=this,e=this.state,n=e.endVertex,o=e.p,r=e.p_,i=e.title;return v.default.createElement(y.default,null,v.default.createElement(R,{p:o,p_:r}),v.default.createElement(A,{ps:this.ps,ps_:this.ps_}),v.default.createElement(X,{title:i,p:o,p_:r,ref:function(e){e&&(t.forceUpdateLandmark=e.forceUpdate)}}),v.default.createElement(B,{vertices:this.vertices,vertices_:this.vertices_,endVertex:n}))}}]),e}(v.default.Component);e.default=N},201:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u);n(202);var c=3,f=5,h=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=n.props,a=o.itemSize,s=o.itemSpacer,u=o.index,l=o.events,c=o.shrinked,f=a.width+s;return n.state={itemDistance:f,shrinked:c,lastIndex:u,currIndex:u,isDragging:!1},n.cardNum=l.length,n.startX=0,n.startY=0,n.vx=0,n.lastX=0,n.isStarted=!1,n.isSwiping=!1,n.autoPlayId=null,n.shrinkedTimerId=null,n.touchTarget=null,n.handleTouchStart=n.handleTouchStart.bind(n),n.handleTouchMove=n.handleTouchMove.bind(n),n.handleTouchEnd=n.handleTouchEnd.bind(n),n.onTransitionEnd=n.onTransitionEnd.bind(n),n.autoPlay=n.autoPlay.bind(n),n}return a(e,t),s(e,[{key:"handleTouchStart",value:function(t){var e=t.touches[0];this.touchTarget=e.target,this.state.shrinked||this.props.disableControl||(this.startX=e.pageX,this.startY=e.pageY,this.vx=0,this.lastX=e.pageX,this.isStarted=!0,this.isSwiping=!1)}},{key:"handleTouchMove",value:function(t){if(!this.state.shrinked&&!this.props.disableControl){if(!this.isStarted)return void this.handleTouchStart(t);var e=t.touches[0];if(!this.isSwiping){var n=Math.abs(this.startX-e.pageX),o=Math.abs(this.startY-e.pageY);n>o&&t.preventDefault();var r=n>o&&n>c;return void((1==r||o>c)&&(this.isSwiping=r,this.startX=e.pageX))}this.state.isDragging||this.setState({isDragging:!0}),t.preventDefault(),this.vx=.5*this.vx+.5*(e.pageX-this.lastX),this.lastX=e.pageX;var i=this.computeIndex({startX:this.startX,currX:e.pageX,cardNum:this.cardNum}),a=i.startX,s=i.index;this.setState({currIndex:s}),this.startX=a}}},{key:"handleTouchEnd",value:function(){if(!this.props.disableControl){var t=this.state.shrinked,e=this.props.onChangeShinked;if(t)return void(this.touchTarget&&"card-item"==this.touchTarget.classList[0]&&e(!1));if(this.isStarted){if(this.isStarted=!1,!this.isSwiping&&!t)return void e(!0);var n=this.state,o=n.lastIndex,r=n.currIndex,i=void 0;i=this.vx>f?Math.floor(r):this.vx<-f?Math.ceil(r):Math.abs(o-r)>.6?Math.round(r):o,this.goTo(i)}}}},{key:"goTo",value:function(t){var e=this.props.onChangeIndex,n=this.cardNum-1;t<0?t=0:t>n&&(t=n),this.setState({currIndex:t,lastIndex:t,isDragging:!1},function(n){e&&e(t)})}},{key:"computeIndex",value:function(t){var e=this.state,n=e.lastIndex,o=e.itemDistance,r=t.startX,i=t.currX,a=t.cardNum,s=a-1,u=n+(r-i)/o,l=r;return u<0&&(u=0,l=(u-n)*o+i),u>s&&(u=s,l=(u-n)*o+i),{startX:l,index:u}}},{key:"componentWillReceiveProps",value:function(t){var e=this,n=t.itemSize,o=t.itemSpacer,r=t.index,i=t.events,a=t.autoPlay,s=t.shrinked,u=this.props,l=u.itemSize,c=u.itemSpacer,f=u.index,h=u.events,d=u.autoPlay,p=u.shrinked;if(h!=i&&(this.cardNum=i.length),f!=r&&this.setState({lastIndex:r,currIndex:r}),c!=o||l!=n){var v=n.width+o;this.setState({itemDistance:v})}p!=s&&(s?this.setState({shrinked:!0}):(clearTimeout(this.shrinkedTimerId),this.shrinkedTimerId=setTimeout(function(t){e.setState({shrinked:!1})},2500))),d!=a&&(a?this.autoPlay():clearTimeout(this.autoPlayId))}},{key:"onTransitionEnd",value:function(){}},{key:"autoPlay",value:function(){var t=this,e=this.props,n=e.index,o=e.resetAutoPlay,r=n+1;r<this.cardNum?(this.goTo(r),this.autoPlayId=setTimeout(this.autoPlay,2e3)):(clearTimeout(this.autoPlayId),this.autoPlayId=setTimeout(function(e){o(),t.goTo(0)},2e3))}},{key:"componentDidMount",value:function(){var t=this.props.autoPlay;t&&this.autoPlay()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.autoPlayId)}},{key:"render",value:function(){var t=this.state,e=t.itemDistance,n=t.currIndex,o=t.isDragging,r=t.shrinked,i=this.props,a=i.containerSize,s=i.itemSize,u=i.events,c=s.width,f=s.height;r&&(c=50,f=50);var h=e*u.length,d=e*n,p=!(o||r),v="translate3d(-"+d+"px,0,0)";return l.default.createElement("div",{style:a,className:"card-container"},l.default.createElement("div",{ref:"surface",className:"card-surface"+(p?" card-surface-transition":""),style:{width:h,height:f,marginLeft:-c/2,marginTop:-f/2,transform:v,WebkitTransform:v},onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,onTransitionEnd:this.onTransitionEnd},u.map(function(t,o){return l.default.createElement("div",{key:t.id,className:"card-item-wrapper"+(r?" card-shrinked":""),style:{width:c,height:f,position:"absolute",top:0,left:e*o}},l.default.createElement("div",{className:"card-item"+(n==o?" card-item-active":""),style:{width:c,height:f}},l.default.createElement("div",{className:"card-item-inner",style:{height:f-10}},l.default.createElement("p",null,t.summary))))})))}}]),e}(l.default.Component);h.propTypes={containerSize:l.default.PropTypes.object.isRequired,itemSize:l.default.PropTypes.object.isRequired,itemSpacer:l.default.PropTypes.number,events:l.default.PropTypes.array,index:l.default.PropTypes.number,autoPlay:l.default.PropTypes.bool,onChangeIndex:l.default.PropTypes.func},h.defaultProps={itemSpacer:10,index:0,events:[],autoPlay:!1},e.default=h},202:function(t,e,n){var o=n(203);"string"==typeof o&&(o=[[t.id,o,""]]);n(185)(o,{});o.locals&&(t.exports=o.locals)},203:function(t,e,n){e=t.exports=n(184)(),e.push([t.id,'.card-container{position:fixed;bottom:10px;z-index:500}.card-surface{position:absolute;left:50%;top:50%;will-change:transform;transition:height .3s ease,margin .3s ease;-webkit-transform:translateZ(0);transform:translateZ(0)}.card-surface-transition{transition:transform .3s ease}.card-item-wrapper{position:"absolute"}.card-item{background:hsla(0,0%,100%,0);position:relative;border-radius:5px;border:1px solid #69f;will-change:transform;box-shadow:inset 0 0 0 #69f,0 0 0 #69f}.card-item-active{transition:all .3s ease;border:1px solid #69f;box-shadow:inset 0 0 15px #69f,0 0 15px #69f}.card-item-inner{text-shadow:2px 2px 5px #69f;padding:10px 15px;line-height:1.4;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;display:box;-webkit-line-clamp:5;line-clamp:5;-webkit-box-orient:vertical;box-orient:vertical}.card-shrinked .card-item{border-radius:50%}.card-shrinked .card-item-inner{display:none}.card-item-zoomout-btn{width:50px;height:50px;line-height:52px;text-align:center;font-size:24px;color:#69f;display:none}.card-shrinked .card-item-zoomout-btn{display:block}',""])},204:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u);n(205);var c=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=n.props.size,a=o.width,s=o.height,u=o.dh,l=200,c=200;return n.clickBtnClose=n.clickBtnClose.bind(n),n.clickBtnNext=n.clickBtnNext.bind(n),n.tips=[{txt:"切换地图形状：平面/球面",boxStyle:{left:50,top:10,width:l,height:35},flagStyle:{borderTop:"5px solid transparent",borderBottom:"5px solid transparent",borderRight:"8px solid #69f",left:-8,top:5}},{txt:"切换播放状态：自动/手动",boxStyle:{left:50,top:47,width:200,height:35},flagStyle:{borderTop:"5px solid transparent",borderBottom:"5px solid transparent",borderRight:"8px solid #69f",left:-8,top:11}},{img:"./img/tip_zoom.gif",txt:"缩放地图操作",boxStyle:{left:(a-l)/2,top:(s-c)/2-u,width:l,height:c},flagStyle:{visibility:"hidden"}},{img:"./img/tip_click.gif",txt:"点击卡片进入近景模式",boxStyle:{left:(a-l)/2,top:s-u-c-130,width:l,height:c},flagStyle:{borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderTop:"8px solid #69f",left:l/2-5,bottom:-8}},{img:"./img/tip_swipe.gif",txt:"滑动卡片切换当前事件",boxStyle:{left:(a-l)/2,top:s-u-c-130,width:l,height:c},flagStyle:{borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderTop:"8px solid #69f",left:l/2-5,bottom:-8}},{txt:"<p>联系作者： 380683145@qq.com</p>",boxStyle:{left:(a-260)/2,top:(s-70)/2-u,width:260,height:70},flagStyle:{visibility:"hidden"}}],n}return a(e,t),s(e,[{key:"clickBtnNext",value:function(t){t.stopPropagation();var e=this.props.onClickNext;e()}},{key:"clickBtnClose",value:function(t){t.stopPropagation();var e=this.props.onClickClose;e()}},{key:"render",value:function(){var t=this.props.tipIdx,e=this.tips[t],n=e.img,o=e.txt,r=e.boxStyle,i=e.flagStyle;return l.default.createElement("div",{className:"tip-mask",onClick:this.clickBtnNext},l.default.createElement("div",{className:"tip-btn-close",onClick:this.clickBtnClose},l.default.createElement("span",{className:"glyphicon glyphicon-remove-sign"})),l.default.createElement("div",{className:"tip-txt",style:r},l.default.createElement("div",{className:"tip-btn-next"},l.default.createElement("span",{className:"glyphicon glyphicon-circle-arrow-right"})),l.default.createElement("div",{className:"tip-txt-triangle",style:i}),l.default.createElement("div",{className:"tip-txt-inner",dangerouslySetInnerHTML:{__html:o}}),n?l.default.createElement("img",{src:n,alt:"tip",width:200}):""))}}]),e}(l.default.Component);e.default=c},205:function(t,e,n){var o=n(206);"string"==typeof o&&(o=[[t.id,o,""]]);n(185)(o,{});o.locals&&(t.exports=o.locals)},206:function(t,e,n){e=t.exports=n(184)(),e.push([t.id,".tip-mask{position:fixed;left:0;right:0;top:0;bottom:0;background:#000;background:rgba(0,0,0,.7);z-index:9999}.tip-btn-next{width:60px;height:60px;left:50%;margin-left:-30px;bottom:-80px;font-size:40px;line-height:2;color:#69f;text-shadow:0 0 5px #69f}.tip-btn-close,.tip-btn-next{position:absolute;text-align:center}.tip-btn-close{z-index:10002;width:30px;height:30px;line-height:30px;font-size:20px;color:#fff;left:5px;top:95px}.tip-txt{position:absolute;border:1px solid #69f;border-radius:5px;box-shadow:inset 0 0 5px #fff;transition:width .5s ease,height .5s ease,top .5s ease,left .5s ease}.tip-txt-inner{padding:5px 8px;color:#69f;text-align:center}.tip-txt-triangle{position:absolute;border-box:content-box;width:0;height:0}.tip-txt img{display:block;margin:0 auto}",""])},207:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(3),l=o(u);n(208);var c=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.onClick=n.onClick.bind(n),n}return a(e,t),s(e,[{key:"onClick",value:function t(e){var t=this.props.onClick;t&&t()}},{key:"render",value:function(){var t=this.props,e=t.size,n=t.children,o=e.width,r=e.height;return l.default.createElement("div",{className:"menu-container",onClick:this.onClick},l.default.createElement("div",{className:"menu-head"},"相关剧情线"),l.default.createElement("div",{className:"menu-box",style:{width:o,maxHeight:r}},l.default.createElement("div",{className:"list-group"}," ",n," ")))}}]),e}(l.default.Component);e.default=c},208:function(t,e,n){var o=n(209);"string"==typeof o&&(o=[[t.id,o,""]]);n(185)(o,{});o.locals&&(t.exports=o.locals)},209:function(t,e,n){e=t.exports=n(184)(),e.push([t.id,".menu-container{position:fixed;left:0;top:0;right:0;bottom:0;z-index:2000;background:#000;background:rgba(0,0,0,.6)}.menu-head{height:40px;background:#69f;color:#000;font-size:15px;text-align:center;line-height:40px}.menu-box{overflow-x:hidden;overflow-y:auto}.menu-box .list-group-item:first-child{border-top-left-radius:0;border-top-right-radius:0}.menu-item-current{background:#eee;color:#69f}",""])},210:function(t,e,n){var o=n(211);"string"==typeof o&&(o=[[t.id,o,""]]);n(185)(o,{});o.locals&&(t.exports=o.locals)},211:function(t,e,n){e=t.exports=n(184)(),e.push([t.id,"@-webkit-keyframes twinkle{0%{opacity:1}to{opacity:.4}}@keyframes twinkle{0%{opacity:1}to{opacity:.4}}.space{position:fixed;z-index:300;overflow:hidden}.toggle-btn{position:absolute;z-index:1000;width:30px;height:30px;line-height:30px;font-size:20px;text-align:center}.toggle-btn.toggle-btn-playing{animation:twinkle .8s ease 0s infinite alternate;-webkit-animation:twinkle .8s ease 0s infinite alternate}.toggle-btn.toggle-btn-menu{z-index:2001}.tip-0 .toggle-btn-morph,.tip-1 .toggle-btn-play{z-index:10000;color:#69f}.btns-tip-overlayer{position:fixed;left:0;top:0;width:40px;height:90px;z-index:10001}",""])}});